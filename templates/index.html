<!DOCTYPE html>
<html>
<head>
    <!-- ... -->
</head>
<body>
    <div class="container">
        <form action="/assign-rights" method="post" onsubmit="return validateForm()">
            <table class="table">
                <thead>
                    <!-- ... -->
                </thead>
                <tbody>
                    {% for person in personnel %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ person.Last_Name }}</td>
                        <td>{{ person.First_Name }}</td>
                        <td>{{ person.Position }}</td>
                        <td>{{ person.Email }}</td>
                        <td class="privileges">
                            <select name="privileges_{{ person.Last_Name }}">
                                {% for privilege in person.Assumed_Database_Access %}
                                <option value="{{ privilege }}">{{ privilege }}</option>
                                {% endfor %}
                            </select>
                            <button type="button" onclick="appendPrivilegesToRemarks('{{ person.Last_Name }}')">Add More</button>
                        </td>
                        <td class="remarks"><input type="text" name="remarks_{{ person.Last_Name }}" value="{{ person.Remarks }}"></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <button type="submit" class="btn btn-primary">Assign Rights</button>
        </form>
    </div>
    <script>
        function appendPrivilegesToRemarks(lastName) {
            // Get the privileges dropdown and remarks field
            var privilegesDropdown = document.querySelector('select[name="privileges_' + lastName + '"]');
            var remarksField = document.querySelector('input[name="remarks_' + lastName + '"]');

            // Get the selected privilege
            var selectedPrivilege = privilegesDropdown.options[privilegesDropdown.selectedIndex].value;

            // Append the selected privilege to the remarks
            var newRemarks = remarksField.value + ' ' + selectedPrivilege;

            // Update the remarks field with the new value
            remarksField.value = newRemarks;
        }
        function validateForm() {
            // Get all the remarks fields
            var remarksFields = document.querySelectorAll('input[name^="remarks_"]');

            // Check each field
            for (var i = 0; i < remarksFields.length; i++) {
                if (remarksFields[i].value.trim() === '') {
                    // If a field is empty, show an alert and prevent form submission
                    alert('Please fill out all remarks fields.');
                    return false;
                }
            }

            // If all fields are filled, allow form submission
            return true;
        }
    </script>
</body>
</html>
